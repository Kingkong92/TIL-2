[toc]

# Day44 딥러닝을 위한 빅데이터 기초-R(13)

프로젝트 주제

1. 미세먼지 데이터를 이용한 미세먼지 예측(좋음/나쁨)
   - 제공된 데이터셋 + 기상청 데이터셋
2. 제공되는 뉴스 데이터셋을 이용하여 새로운 뉴스에 대해 카테고리화(JSON 포맷)
   - 감성분석(한국어감성사전_군산대)
3. 아파트 관리비 분석
   - LH공사 데이터셋 사용
4. 텍스트 마이닝
   - 신문, 블로그 등 웹으로부터 읽어들인 텍스트 기반 마이닝
   - 토픽모델링, 감성분석 등
5. 베이커리 -> 연관규칙

# json, xlsx, txt, xml 파일 읽기

## josn

```R
# install.packages("jsonlite")
library(jsonlite)
```

```R
data = fromJSON("sample.json")
head(data)
##      [,1]              [,2] [,3] [,4] [,5]  
## [1,] "226906700999825" "52" "25" "3"  "2591"
## [2,] "226741927682969" "28" "8"  "0"  "939" 
## [3,] "226216251068870" "29" "8"  "0"  "1234"
## [4,] "226282867728875" "17" "3"  "2"  "418" 
## [5,] "224387614585067" "13" "2"  "0"  "500" 
## [6,] "224374587919703" "27" "16" "4"  "1528"
##      [,6]                                                                                                                                                                          
## [1,] "<3D 화상통화 홀로포트>홀로렌즈를 착용하고 통화하면사랑하는 사람이 내 눈 앞에 나타난다.#마이크로소프트 #홀로포트 #순간이동"                                                   
## [2,] "하늘을 날자!#jetpack #시속160km #40년간한우물만팠습니다"                                                                                                                     
## [3,] "최저임금을 올려달라고 사정하는 백만장자들. 이유를 들어보면, 납득이 간다.#너무나낯선풍경 #애국하는백만장자 #patriotmillinaires #최저임금우리는0프로올리자고그랬었는데 #ㄱ나니"
## [4,] "귀신이 아니다. 홀로렌즈 쓴 눈에만 보이는 좀비다. #홀로있지않게해주는렌즈 #꿀잼미래 #리얼퓨처 #realfuture #내눈에만보인단말이야 #그와중에좀비귀여움"                          
## [5,] "이들은 수백만 달러를 들여 미국 의회에 로비를 한다. 나쁜 사람들일까? 로비의 내용을 보면 당신은 깜짝 놀랄 것. 반전이 숨어있다."                                                
## [6,] "이제는 3D 프린터로 만든 옷도 입을 수 있다!"                                                                                                                                  
##      [,7]                      
## [1,] "2016-04-06T03:00:00+0000"
## [2,] "2016-04-05T03:00:00+0000"
## [3,] "2016-04-04T09:00:00+0000"
## [4,] "2016-04-04T05:00:00+0000"
## [5,] "2016-04-01T09:00:00+0000"
## [6,] "2016-04-01T04:00:00+0000"
```

```R
str(data)
##  chr [1:27, 1:7] "226906700999825" "226741927682969" "226216251068870" ...
```

```R
data = data.frame(data)
head(data)
##                X1 X2 X3 X4   X5
## 1 226906700999825 52 25  3 2591
## 2 226741927682969 28  8  0  939
## 3 226216251068870 29  8  0 1234
## 4 226282867728875 17  3  2  418
## 5 224387614585067 13  2  0  500
## 6 224374587919703 27 16  4 1528
##                                                                                                                                                                             X6
## 1                                                    <3D 화상통화 홀로포트>홀로렌즈를 착용하고 통화하면사랑하는 사람이 내 눈 앞에 나타난다.#마이크로소프트 #홀로포트 #순간이동
## 2                                                                                                                      하늘을 날자!#jetpack #시속160km #40년간한우물만팠습니다
## 3 최저임금을 올려달라고 사정하는 백만장자들. 이유를 들어보면, 납득이 간다.#너무나낯선풍경 #애국하는백만장자 #patriotmillinaires #최저임금우리는0프로올리자고그랬었는데 #ㄱ나니
## 4                           귀신이 아니다. 홀로렌즈 쓴 눈에만 보이는 좀비다. #홀로있지않게해주는렌즈 #꿀잼미래 #리얼퓨처 #realfuture #내눈에만보인단말이야 #그와중에좀비귀여움
## 5                                                 이들은 수백만 달러를 들여 미국 의회에 로비를 한다. 나쁜 사람들일까? 로비의 내용을 보면 당신은 깜짝 놀랄 것. 반전이 숨어있다.
## 6                                                                                                                                   이제는 3D 프린터로 만든 옷도 입을 수 있다!
##                         X7
## 1 2016-04-06T03:00:00+0000
## 2 2016-04-05T03:00:00+0000
## 3 2016-04-04T09:00:00+0000
## 4 2016-04-04T05:00:00+0000
## 5 2016-04-01T09:00:00+0000
## 6 2016-04-01T04:00:00+0000
```

```R
names(data) = c("id", "like", "share", "comment", "unique", "msg", "time")
head(data)
##                id like share comment unique
## 1 226906700999825   52    25       3   2591
## 2 226741927682969   28     8       0    939
## 3 226216251068870   29     8       0   1234
## 4 226282867728875   17     3       2    418
## 5 224387614585067   13     2       0    500
## 6 224374587919703   27    16       4   1528
##                                                                                                                                                                            msg
## 1                                                    <3D 화상통화 홀로포트>홀로렌즈를 착용하고 통화하면사랑하는 사람이 내 눈 앞에 나타난다.#마이크로소프트 #홀로포트 #순간이동
## 2                                                                                                                      하늘을 날자!#jetpack #시속160km #40년간한우물만팠습니다
## 3 최저임금을 올려달라고 사정하는 백만장자들. 이유를 들어보면, 납득이 간다.#너무나낯선풍경 #애국하는백만장자 #patriotmillinaires #최저임금우리는0프로올리자고그랬었는데 #ㄱ나니
## 4                           귀신이 아니다. 홀로렌즈 쓴 눈에만 보이는 좀비다. #홀로있지않게해주는렌즈 #꿀잼미래 #리얼퓨처 #realfuture #내눈에만보인단말이야 #그와중에좀비귀여움
## 5                                                 이들은 수백만 달러를 들여 미국 의회에 로비를 한다. 나쁜 사람들일까? 로비의 내용을 보면 당신은 깜짝 놀랄 것. 반전이 숨어있다.
## 6                                                                                                                                   이제는 3D 프린터로 만든 옷도 입을 수 있다!
##                       time
## 1 2016-04-06T03:00:00+0000
## 2 2016-04-05T03:00:00+0000
## 3 2016-04-04T09:00:00+0000
## 4 2016-04-04T05:00:00+0000
## 5 2016-04-01T09:00:00+0000
## 6 2016-04-01T04:00:00+0000
```

### data.frame -> json

```R
dataJson = toJSON(data)
dataJson
## [{"id":"226906700999825","like":"52","share":"25","comment":"3","unique":"2591","msg":"<3D 화상통화 홀로포트>홀로렌즈를 착용하고 통화하면사랑하는 사람이 내 눈 앞에 나타난다.#마이크로소프트 #홀로포트 #순간이동","time":"2016-04-06T03:00:00+0000"},{"id":"226741927682969","like":"28","share":"8","comment":"0","unique":"939","msg":"하늘을 날자!#jetpack #시속160km #40년간한우물만팠습니다","time":"2016-04-05T03:00:00+0000"},{"id":"226216251068870","like":"29","share":"8","comment":"0","unique":"1234","msg":"최저임금을 올려달라고 사정하는 백만장자들. 이유를 들어보면, 납득이 간다.#너무나낯선풍경 #애국하는백만장자 #patriotmillinaires #최저임금우리는0프로올리자고그랬었는데 #ㄱ나니","time":"2016-04-04T09:00:00+0000"},{"id":"226282867728875","like":"17","share":"3","comment":"2","unique":"418","msg":"귀신이 아니다. 홀로렌즈 쓴 눈에만 보이는 좀비다. #홀로있지않게해주는렌즈 #꿀잼미래 #리얼퓨처 #realfuture #내눈에만보인단말이야 #그와중에좀비귀여움","time":"2016-04-04T05:00:00+0000"},{"id":"224387614585067","like":"13","share":"2","comment":"0","unique":"500","msg":"이들은 수백만 달러를 들여 미국 의회에 로비를 한다. 나쁜 사람들일까? 로비의 내용을 보면 당신은 깜짝 놀랄 것. 반전이 숨어있다.","time":"2016-04-01T09:00:00+0000"},{"id":"224374587919703","like":"27","share":"16","comment":"4","unique":"1528","msg":"이제는 3D 프린터로 만든 옷도 입을 수 있다!","time":"2016-04-01T04:00:00+0000"},{"id":"223198558037306","like":"32","share":"7","comment":"2","unique":"948","msg":"누워서도 일할 수 있다는 사실에 특히 일부 직종(?)의 사람들이 열광하는 중.","time":"2016-03-31T04:00:00+0000"},{"id":"223272154696613","like":"46","share":"5","comment":"0","unique":"1347","msg":"엄마 왜 나를 닮은 인형은 없어?","time":"2016-03-30T23:00:00+0000"},{"id":"222529754770853","like":"8","share":"1","comment":"0","unique":"361","msg":"닝겐노 resigns……이것이 일본 문학상 1차 심사를 통과한 인공지능이 쓴 소설이다.","time":"2016-03-30T09:00:00+0000"},{"id":"221504484873380","like":"7351","share":"2253","comment":"1860","unique":"635344","msg":"그렇고 그런 타투가 아니다. 5초 뒤, 팔 위의 타투가 움직이기 시작한다.","time":"2016-03-30T04:00:00+0000"},{"id":"222092254814603","like":"25","share":"0","comment":"1","unique":"724","msg":"가비는 다리를 절단 했지만, 다시 발레를 시작했다. 수많은 사람들이 그의 메시지를 듣고 다시 용기를 얻었다.","time":"2016-03-29T23:00:00+0000"},{"id":"221929571497538","like":"33","share":"4","comment":"5","unique":"1357","msg":"롯데 타워는 123층. 한국에서 가장 높은 건물을 이 남자가 정복했다.","time":"2016-03-29T09:00:00+0000"},{"id":"221927938164368","like":"130","share":"39","comment":"15","unique":"8262","msg":"트위터 반응 남의 키스에 왜 감 놔라 배 놔라냐. 그런데, 김치 싸대기보다 백합 키스가 더 나쁜 걸까?","time":"2016-03-29T04:00:00+0000"},{"id":"221501774873651","like":"14","share":"1","comment":"0","unique":"533","msg":"비포앤애프터 둘 다 아름답다. 반전의 뷰티 유투버 샬롬. 그는 말한다. 사람들이 당신의 외모에 대해 뭐라고 떠들든 당신의 인생을 살아요. ","time":"2016-03-28T23:00:00+0000"},{"id":"221329481557547","like":"15","share":"5","comment":"1","unique":"530","msg":"그들은 유방암 수술 후 남은 흉터위에 이것을 그렸다","time":"2016-03-28T09:00:00+0000"},{"id":"221192041571291","like":"77","share":"20","comment":"5","unique":"4891","msg":"선거 토론 방송에서 자신의 성기 크기에 대해 말한 트럼프. 그리고 미국 대학생 미디어의 반응","time":"2016-03-28T04:00:00+0000"},{"id":"218727625151066","like":"32","share":"16","comment":"3","unique":"714","msg":"귀여운 성기 캐릭터가 알려주는 동의에 대해 들어보자","time":"2016-03-25T09:00:00+0000"},{"id":"218722625151566","like":"8","share":"5","comment":"0","unique":"308","msg":"갈색거저리 애벌레로 만든 푸딩, 맛있을까?","time":"2016-03-25T04:00:00+0000"},{"id":"217796218577540","like":"19","share":"5","comment":"0","unique":"489","msg":"5. 지카 바이러스의 치료법은 아직 없고, 백신 개발은 초기 단계다.","time":"2016-03-24T09:00:00+0000"},{"id":"217797931910702","like":"11","share":"1","comment":"0","unique":"222","msg":"아이돌을 하드코어한 직업으로 만드는 그 프로그램 얘기다.","time":"2016-03-24T04:00:00+0000"},{"id":"217390641951431","like":"14","share":"3","comment":"0","unique":"530","msg":"폭식증을 겪었던 요가 강사, 아름다운가요?","time":"2016-03-23T23:00:00+0000"},{"id":"216768658680296","like":"10","share":"4","comment":"0","unique":"481","msg":"시리아의 이야기는 여전히 현재 진행중이고, 조지 클루니는 그걸 잊지 않았다.","time":"2016-03-23T04:00:00+0000"},{"id":"216737852016710","like":"11","share":"1","comment":"0","unique":"259","msg":"이 예술가는 몸에 그린 그림으로 메시지를 전한다","time":"2016-03-22T23:00:00+0000"},{"id":"216721818684980","like":"39","share":"5","comment":"6","unique":"1211","msg":"사용자 프라이버시에 대한 애플의 단호한 입장.신제품 발표회인데, 가장 민감한 이슈부터 건드리고 시작한다","time":"2016-03-22T08:30:15+0000"},{"id":"216146125409216","like":"23","share":"6","comment":"1","unique":"1105","msg":"새로나온 나이키 신발 자동으로 끈을 묶어준다. 두둥!","time":"2016-03-22T04:00:00+0000"},{"id":"216175605406268","like":"175","share":"39","comment":"7","unique":"8667","msg":"페미니즘은 남성을 향한 여성의 싸움이 아니다","time":"2016-03-21T23:00:00+0000"},{"id":"216060345417794","like":"51","share":"6","comment":"2","unique":"2487","msg":"엠마 왓슨, 페미니즘 랩에 비트박스 풍치팡치","time":"2016-03-21T11:14:18+0000"}]
```

### 파일저장

```R
wirte(dataJson, "data.json")
```

## xlsx

```R
# install.packages("readxl")
library(readxl)
```

```R
cust_profile = read_excel("cust_profile.xlsx", 
                          sheet = "cust_profile",
                          range = "B3:E8", 
                          col_names = TRUE, na = "NA")
cust_profile
## # A tibble: 5 x 4
##   ID    gender   age name 
##   <chr> <chr>  <dbl> <chr>
## 1 c1    F         30 Kim  
## 2 c2    M         28 Lee  
## 3 c3    <NA>      46 Park 
## 4 c4    M         65 Moon 
## 5 c5    F         38 Choi
```

```R
cust_profile = read_excel("cust_profile.xlsx", 
                          sheet = "cust_profile",
                          # range = "B3:E8", 
                          col_names = TRUE, na = "NA",
                          skip = 2)
cust_profile
## # A tibble: 5 x 4
##   ID    gender   age name 
##   <chr> <chr>  <dbl> <chr>
## 1 c1    F         30 Kim  
## 2 c2    M         28 Lee  
## 3 c3    <NA>      46 Park 
## 4 c4    M         65 Moon 
## 5 c5    F         38 Choi
```

## txt

```R
dataset_1 = read.table("dataset_1.txt")
dataset_1
##         V1         V2  V3
## 1 cust_id, last_name, age
## 2       1,       Kim,  32
## 3       2,       Lee,  29
## 4       3,      Choi,  45
## 5       4,      Park,  38
## 6       5,       Lim,
```

```R
dataset_1 = read.table("dataset_1.txt", header = TRUE,
                       sep = ",", 
                       stringsAsFactors = FALSE,
                       na.strings = "") # ""를 NA로 처리
dataset_1
##   cust_id last_name age
## 1       1       Kim  32
## 2       2       Lee  29
## 3       3      Choi  45
## 4       4      Park  38
## 5       5       Lim  NA
```

## xml

```R
# install.packages("XML")
library(XML)
```

```R
res = xmlToDataFrame("test.xml")
res
##   ID     NAME SALARY  STARTDATE       DEPT
## 1  1     Rick  623.3   1/1/2012         IT
## 2  2      Dan  515.2  9/23/2013 Operations
## 3  3 Michelle    611 11/15/2014         IT
## 4  4     Ryan    729  5/11/2014         HR
## 5  5     Gary 843.25  3/27/2015    Finance
## 6  6     Nina    578  5/21/2013         IT
## 7  7    Simon  632.8  7/30/2013 Operations
## 8  8     Guru  722.5  6/17/2014    Finance
```

### 다른 방법

```R
res2 = xmlParse("test.xml")
res2
## <?xml version="1.0"?>
## <RECORDS>
##   <EMPLOYEE>
##     <ID>1</ID>
##     <NAME>Rick</NAME>
##     <SALARY>623.3</SALARY>
##     <STARTDATE>1/1/2012</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>2</ID>
##     <NAME>Dan</NAME>
##     <SALARY>515.2</SALARY>
##     <STARTDATE>9/23/2013</STARTDATE>
##     <DEPT>Operations</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>3</ID>
##     <NAME>Michelle</NAME>
##     <SALARY>611</SALARY>
##     <STARTDATE>11/15/2014</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>4</ID>
##     <NAME>Ryan</NAME>
##     <SALARY>729</SALARY>
##     <STARTDATE>5/11/2014</STARTDATE>
##     <DEPT>HR</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>5</ID>
##     <NAME>Gary</NAME>
##     <SALARY>843.25</SALARY>
##     <STARTDATE>3/27/2015</STARTDATE>
##     <DEPT>Finance</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>6</ID>
##     <NAME>Nina</NAME>
##     <SALARY>578</SALARY>
##     <STARTDATE>5/21/2013</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>7</ID>
##     <NAME>Simon</NAME>
##     <SALARY>632.8</SALARY>
##     <STARTDATE>7/30/2013</STARTDATE>
##     <DEPT>Operations</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>8</ID>
##     <NAME>Guru</NAME>
##     <SALARY>722.5</SALARY>
##     <STARTDATE>6/17/2014</STARTDATE>
##     <DEPT>Finance</DEPT>
##   </EMPLOYEE>
## </RECORDS>
## 
```

```R
rt = xmlRoot(res2)
rt
## <RECORDS>
##   <EMPLOYEE>
##     <ID>1</ID>
##     <NAME>Rick</NAME>
##     <SALARY>623.3</SALARY>
##     <STARTDATE>1/1/2012</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>2</ID>
##     <NAME>Dan</NAME>
##     <SALARY>515.2</SALARY>
##     <STARTDATE>9/23/2013</STARTDATE>
##     <DEPT>Operations</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>3</ID>
##     <NAME>Michelle</NAME>
##     <SALARY>611</SALARY>
##     <STARTDATE>11/15/2014</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>4</ID>
##     <NAME>Ryan</NAME>
##     <SALARY>729</SALARY>
##     <STARTDATE>5/11/2014</STARTDATE>
##     <DEPT>HR</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>5</ID>
##     <NAME>Gary</NAME>
##     <SALARY>843.25</SALARY>
##     <STARTDATE>3/27/2015</STARTDATE>
##     <DEPT>Finance</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>6</ID>
##     <NAME>Nina</NAME>
##     <SALARY>578</SALARY>
##     <STARTDATE>5/21/2013</STARTDATE>
##     <DEPT>IT</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>7</ID>
##     <NAME>Simon</NAME>
##     <SALARY>632.8</SALARY>
##     <STARTDATE>7/30/2013</STARTDATE>
##     <DEPT>Operations</DEPT>
##   </EMPLOYEE>
##   <EMPLOYEE>
##     <ID>8</ID>
##     <NAME>Guru</NAME>
##     <SALARY>722.5</SALARY>
##     <STARTDATE>6/17/2014</STARTDATE>
##     <DEPT>Finance</DEPT>
##   </EMPLOYEE>
## </RECORDS>
```

```R
rt[[1]]
## <EMPLOYEE>
##   <ID>1</ID>
##   <NAME>Rick</NAME>
##   <SALARY>623.3</SALARY>
##   <STARTDATE>1/1/2012</STARTDATE>
##   <DEPT>IT</DEPT>
## </EMPLOYEE>
```

```R
rt[[1]][[1]]; rt[[1]][[2]]
## <ID>1</ID>
## <NAME>Rick</NAME>
```

